#!/bin/sh -eux

# --disable-openssl: GnuTLS and OpenSSL must not be enabled at the same time.
# a gnutls kevésbé problémás (API változások probléma)

configopts="
	--prefix=/usr \
	--disable-static \
	--enable-shared \
	--enable-gray \
	--disable-debug \
	--mandir=/usr/share/man \
	--enable-pic \
	--enable-pthreads \
	--enable-postproc \
"
licensing="
	--enable-gpl \
	--enable-nonfree \
	--enable-version3
"
doksik="
	--disable-podpages \
	--disable-htmlpages \
	--disable-txtpages
"
extlibs="
    --disable-libopencv \
    --disable-libsmbclient \
    --disable-libtesseract \
    --disable-libvidstab \
	--enable-gcrypt \
	--enable-gnutls \
	--enable-gmp \
	--enable-libaom \
	--enable-libass \
	--enable-libbluray \
	--enable-libcaca \
	--enable-libcdio \
	--enable-libdav1d \
	--enable-libdc1394 \
	--enable-libdrm \
	--enable-libfdk-aac \
	--enable-libfontconfig \
	--enable-libfreetype \
	--enable-libfribidi \
	--enable-libgme \
	--enable-libgsm \
	--enable-libiec61883 \
	--enable-libmodplug \
	--enable-libmp3lame \
	--enable-libopencore-amrnb \
	--enable-libopencore-amrwb \
	--enable-libopenjpeg \
	--enable-libopus \
	--enable-libpulse \
	--enable-librsvg \
	--enable-libspeex \
	--enable-libssh \
	--enable-libsoxr \
	--enable-libtheora \
	--enable-libv4l2 \
	--enable-libvorbis \
	--enable-libvpx \
	--enable-libwebp \
	--enable-libx264 \
	--enable-libx265 \
	--enable-libxvid \
	--enable-libxml2 \
	--enable-libzmq \
	--enable-libzvbi
	--enable-openal \
	--enable-opengl \
  "

export CFLAGS='-Wno-error=incompatible-pointer-types'
./configure \
	$configopts \
	$licensing \
	$doksik \
	$extlibs
ub_make

extratools="aviocat graph2dot ismindex pktdumper qt-faststart trasher cws2fws"
for i in $extratools; do
	make "tools/$i"
done
